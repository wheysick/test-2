<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Free Sample ‚Äî Weekly Wellness Formula</title>
  <meta name="robots" content="noindex,nofollow" />
  <meta name="theme-color" content="#ff2a6d" />
  <style>
  /* ===== style.css v5.0 ‚Äî Base advertorial (high-contrast, premium) ===== */
  :root{
    --bg:#0a0c10;
    --surface:#0e1116;
    --ink:#e9ecf2;
    --ink-dim:#c8cdd7;
    --muted:rgba(255,255,255,.06);
    --border:rgba(255,255,255,.12);
    --accent:#C471F5;
    --accent2:#FA71CD;
    --radius:16px;
    --wrap:max(320px, min(920px, 94vw));
    --shadow:0 22px 60px rgba(0,0,0,.55);
    --font:Inter, ui-sans-serif, system-ui, Segoe UI, Arial, sans-serif;
    --h1:clamp(28px, 4vw, 44px);
    --h2:clamp(20px, 3vw, 28px);
    --kicker:12px;
    --body:17px;
    --small:14px;
  }
  *{box-sizing:border-box}
  html,body{margin:0;padding:0;background:var(--bg);color:var(--ink);font-family:var(--font);-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;}
  a{color:#98b7ff;text-decoration:none}
  a:hover{text-decoration:underline}
  .wrap{width:var(--wrap);margin:0 auto;padding:0 0 80px}
  .masthead{
    position:sticky;top:0;z-index:50;background:linear-gradient(180deg,#0b0d12,#0b0d12cc 70%,transparent);
    border-bottom:1px solid var(--border);backdrop-filter:blur(8px);
  }
  .masthead-inner{display:flex;align-items:center;justify-content:space-between;width:var(--wrap);margin:0 auto;padding:10px 0;}
  .brand{font-weight:900;letter-spacing:.4px}
  .masthead-meta{opacity:.9;font-size:13px;display:flex;gap:8px;align-items:center}
  .dot{opacity:.5}
  #scrollProgress{position:absolute;left:0;right:0;bottom:0;height:2px;background:linear-gradient(90deg,var(--accent),var(--accent2));transform:scaleX(0);transform-origin:left;}
  .article{line-height:1.65}
  .article .kicker{font-size:var(--kicker);color:#ffd2f3;letter-spacing:.3px;margin:24px 0 6px;text-transform:uppercase}
  .article .headline{font-size:var(--h1);line-height:1.15;margin:6px 0 8px}
  .byline{opacity:.85;font-size:14px}
  .hero{margin:18px 0}
  .hero img{width:100%;border-radius:12px;display:block;box-shadow:0 14px 38px rgba(0,0,0,.4)}
  .hero figcaption{font-size:13px;color:var(--ink-dim);margin-top:6px}
  .inline-img{margin:18px 0}
  .inline-img img{width:100%;border-radius:12px;display:block}
  .article h2{font-size:var(--h2);margin:26px 0 8px}
  .article ul, .article ol{padding-left:20px}
  .article li{margin:6px 0}
  .note.small{font-size:13px;color:var(--ink-dim)}
  .pullquote{border-left:4px solid var(--accent);padding:8px 14px;margin:18px 0;background:rgba(255,255,255,.04);border-radius:8px}
  .pullquote p{font-size:18px;margin:0}
  .pullquote cite{font-size:13px;opacity:.8}
  .faq h2{margin-top:28px}
  .faq-item{border:1px solid var(--border);border-radius:12px;margin:12px 0;background:var(--surface)}
  .faq-question{width:100%;text-align:left;background:none;border:none;color:var(--ink);padding:12px 14px;font-weight:700;cursor:pointer}
  .faq-answer{padding:0 14px 14px;color:var(--ink-dim)}
  .references li{color:var(--ink-dim)}
  .site-footer{border-top:1px solid var(--border);padding:24px 0;margin-top:40px;text-align:center;color:var(--ink-dim)}
  .share-rail{position:fixed;left:14px;top:120px;display:flex;flex-direction:column;gap:10px}
  @media (max-width:960px){.share-rail{display:none}}
  .share-icon{display:grid;place-items:center;width:40px;height:40px;border-radius:10px;background:var(--surface);border:1px solid var(--border);box-shadow:0 10px 24px rgba(0,0,0,.3)}
  .share-icon:hover{border-color:#99a3ff}
  .floating-cta{
    position:fixed;bottom:16px;left:50%;transform:translateX(-50%);z-index:60;
    background:linear-gradient(90deg,var(--accent),var(--accent2));color:#fff;font-weight:800;
    border:none;border-radius:999px;padding:14px 22px;box-shadow:0 16px 36px rgba(250,113,205,.3);
    touch-action:manipulation;
  }
  @media (min-width:900px){.floating-cta{display:none}}
  .toasts{position:fixed;right:16px;bottom:80px;display:flex;flex-direction:column;gap:10px;z-index:70}
  .view-popup{position:fixed;right:16px;bottom:20px;z-index:70;display:none;align-items:center;gap:10px;background:var(--surface);border:1px solid var(--border);border-radius:14px;padding:10px 12px;color:var(--ink)}
  .view-popup.show{display:flex}
  .view-popup button{background:transparent;border:none;color:#fff;cursor:pointer}
  .hidden{display:none!important}
  /* Ensure any CTA is fast on mobile */
  .cta,[data-cta],.open-checkout,[data-open-checkout]{touch-action:manipulation;cursor:pointer}
  </style>

  <style>
  /* ===== checkout3.css v5.0 ‚Äî Premium dark checkout ===== */
  :root{
    --panel:#0F1319; --fg:#E9ECF2; --muted:rgba(255,255,255,.06); --border:rgba(255,255,255,.12);
    --accent:#C471F5; --accent2:#FA71CD; --radius:16px; --pad:clamp(18px,3.2vw,28px);
    --shadow:0 28px 64px rgba(0,0,0,.55); --body:16px; --small:13.5px; --title:clamp(20px,2.2vw,26px);
  }
  #checkoutModal{display:none;}
  #checkoutModal.show{display:flex!important;}
  #checkoutModal.co-fullscreen{
    position:fixed; inset:0; z-index:999999; align-items:center; justify-content:center;
    background:rgba(5,7,10,.78);
  }
  #checkoutModal .modal-content.checkout-card{
    width:min(92vw,680px); max-height:calc(100dvh - 4rem);
    background:linear-gradient(180deg,rgba(255,255,255,.02),rgba(255,255,255,0)), var(--panel);
    color:var(--fg); border:1px solid rgba(255,255,255,.08); border-radius:var(--radius);
    box-shadow:var(--shadow); overflow:auto; overscroll-behavior:contain; padding:28px var(--pad) 96px;
  }
  #checkoutClose{
    position:fixed; top:14px; right:14px; z-index:1000000; width:44px; height:44px; border-radius:999px;
    border:1px solid rgba(255,255,255,.14); background:rgba(18,19,23,.92); color:#fff; display:flex; align-items:center; justify-content:center;
    backdrop-filter:blur(6px) saturate(120%); cursor:pointer; box-shadow:0 6px 18px rgba(0,0,0,.45);
  }
  .co-pane[hidden], .co-pane[aria-hidden="true"]{display:none!important;}
  .co-h3{font-size:var(--title); font-weight:900; letter-spacing:.2px; text-align:center; margin:4px 0 18px;}
  /* Step 1 */
  #coStep1 .co-grid{display:grid; grid-template-columns:1fr 1fr; gap:14px 16px; margin-top:6px;}
  #coStep1 .co-row{display:grid; grid-template-columns:1fr 1fr 1fr; gap:14px 16px;}
  @media (max-width:640px){
    #coStep1 .co-grid{grid-template-columns:1fr;}
    #coStep1 .co-row{grid-template-columns:1fr;}
  }
  #coStep1 label{font-size:var(--small); opacity:.85; display:flex; flex-direction:column; gap:6px;}
  #coStep1 input{
    width:100%; padding:12px 14px; border-radius:14px; font-size:var(--body);
    border:1px solid var(--border); background:var(--muted); color:var(--fg); outline:none;
  }
  #coStep1 input:focus{border-color:var(--accent); box-shadow:0 0 0 3px rgba(196,113,245,.2);}
  .btn-main{border:none; border-radius:14px; cursor:pointer; font-weight:800; color:#fff; background:linear-gradient(90deg,var(--accent),var(--accent2)); box-shadow:0 10px 24px rgba(250,113,205,.25), 0 2px 0 rgba(0,0,0,.35) inset;}
  .btn-lg{padding:13px 22px; font-size:15px;}
  .btn-sm{padding:10px 16px; font-size:14px;}
  .btn-main:hover{filter:brightness(1.06);}
  /* Step 2 */
  #coStep2{text-align:center;}
  .co-qty{display:flex; justify-content:center; align-items:center; gap:12px; margin:10px 0 8px;}
  .qty-btn{width:44px; height:44px; border-radius:12px; font-size:18px; border:1px solid var(--border); background:var(--muted); color:var(--fg);}
  #coQty{width:82px; text-align:center; padding:12px; border-radius:12px; font-size:16px; border:1px solid var(--border); background:var(--muted); color:var(--fg);}
  .co-free{margin:4px 0 12px; opacity:.95; font-size:var(--body);}
  .co-price{margin:10px 0 16px; font-size:18px;}
  .co-price .was{margin-right:8px; text-decoration:line-through; opacity:.55;}
  .co-price .now{font-weight:800;}
  .co-methods{display:grid; gap:14px; grid-template-columns:repeat(auto-fit,minmax(200px,1fr)); margin:18px 0 10px;}
  .co-method{border:1px solid var(--border); background:linear-gradient(180deg,rgba(255,255,255,.03),rgba(255,255,255,0)); border-radius:14px; padding:16px 14px; text-align:left; color:var(--fg); transition:border .15s ease, box-shadow .15s ease, transform .06s ease; cursor:pointer;}
  .co-method .co-title{font-weight:800;}
  .co-method .co-badge,.co-method .co-discount{opacity:.85; font-size:.92rem; margin-top:4px; display:block;}
  .co-method:hover{border-color:rgba(255,255,255,.25);}
  .co-method:active{transform:translateY(1px);}
  .co-method[aria-selected="true"]{border-color:var(--accent); box-shadow:0 0 0 2px rgba(196,113,245,.35) inset;}
  .co-sticky{position:relative; margin-top:8px;}
  .co-totals{border:1px solid var(--border); border-radius:14px; background:linear-gradient(180deg,rgba(255,255,255,.03),rgba(255,255,255,0)); padding:14px 16px; text-align:left;}
  .co-totals > div{display:flex; align-items:center; justify-content:space-between; gap:12px; padding:6px 0; font-size:var(--body);}
  .co-total-row{border-top:1px dashed var(--border); margin-top:8px; padding-top:10px; font-weight:800;}
  .co-actions{position:sticky; bottom:0; z-index:3; display:flex; justify-content:flex-end; gap:10px; padding:14px var(--pad); background:linear-gradient(180deg,rgba(11,13,17,0),rgba(11,13,17,.88)); backdrop-filter:blur(8px); box-shadow:0 -10px 28px rgba(0,0,0,.35);}
  .co-secure{margin:10px 0 0; text-align:center; opacity:.9; font-size:var(--small);}
  /* Step 3 */
  .cardset{margin:16px 0; padding:14px; border:1px solid var(--border); border-radius:14px;}
  .cardset legend{padding:0 6px; font-size:var(--small); opacity:.9;}
  .co-row{display:grid; grid-template-columns:repeat(3,1fr); gap:12px;}
  @media (max-width:640px){.co-row{grid-template-columns:1fr;}}
  .co-terms{margin:12px 0; font-size:var(--small); opacity:.95;}
  .co-trust{margin-top:8px; text-align:center; opacity:.8; font-size:var(--small);}
  .co-success[hidden]{display:none!important;}
  .co-success h4{font-size:var(--title); font-weight:900; margin:8px 0 6px;}
  /* Kill any theme sticky price bars inside modal */
  #checkoutModal [data-sticky="price"], #checkoutModal #coStickyPrice{display:none!important;}
  </style>
</head>
<body class="verge-theme">
  <header class="masthead" role="banner">
    <div class="masthead-inner">
      <div class="brand">SELFHACKING</div>
      <div class="masthead-meta">
        <span>Free sample ends in <strong id="countdown">00:00:00</strong></span>
        <span class="dot">‚Ä¢</span>
        <span><strong>Shipping cutoff: midnight</strong></span>
      </div>
    </div>
    <div id="scrollProgress"></div>
  </header>

  <!-- Floating CTA (mobile) -->
  <a href="#offer" class="floating-cta open-checkout" id="floatingCta" data-cta="floating"><strong>Claim Free Sample</strong></a>

  <!-- Share rail (desktop) -->
  <nav class="share-rail" aria-label="Share this">
    <a href="#offer" class="share-icon open-checkout" title="Get offer" data-cta>üî•</a>
    <a href="#offer" class="share-icon open-checkout" title="Share" data-cta>‚ÜóÔ∏è</a>
    <a href="#offer" class="share-icon open-checkout" title="Save" data-cta>üîñ</a>
  </nav>

  <!-- Article -->
  <main class="wrap">
    <article class="article" itemscope itemtype="https://schema.org/AdvertiserContentArticle">
      <header class="article-hed">
        <p class="kicker">FEATURE</p>
        <h1 class="headline" itemprop="headline"><strong>BIG PHARMA</strong> To Outlaw Peptide <strong>3X Stronger Than Ozempic!</strong></h1>
        <div class="byline">
          <span class="author" itemprop="author">By Staff Reporter</span>
          <span class="dot">‚Ä¢</span>
          <time id="todayDate" itemprop="datePublished"></time>
          <span class="dot">‚Ä¢</span>
          <span><span id="viewCount">128,000</span> readers</span>
        </div>
      </header>

      <figure class="hero">
        <img src="assets/hero.png" alt="Weekly injector" loading="lazy" decoding="async" />
        <figcaption><em>Lobbyist Push For Federal Crackdowns‚ÄîThousands Are Stocking Up Before It‚Äôs Banned...</em></figcaption>
      </figure>

      <section class="lede">
        <p><strong>Imagine a once‚Äëa‚Äëweek routine</strong> that supports appetite control and balanced energy ‚Äî <em>without the jittery crash</em> of traditional stimulants.</p>
        <p><strong>It‚Äôs 2025,</strong> and a breakthrough treatment has emerged ‚Äî <strong>Tirzepatide</strong>, an injection so powerful it slashes body weight by <strong>20%+</strong>.</p>
      </section>

      <h2>What is it?</h2>
      <figure class="inline-img">
        <img src="assets/tirz.png" alt="TIRZ premium vials" loading="lazy" decoding="async" />
      </figure>
      <ul>
        <li><strong>Each pack</strong> includes <strong>4 weekly servings</strong></li>
        <li><strong>Active ingredients:</strong> <em>clinically studied wellness compounds</em></li>
        <li>Formulated to support <strong>natural metabolism</strong> and <strong>balance</strong></li>
      </ul>
      <p class="note small"><em>*Inspired by modern GLP‚Äë1/GIP research.</em> <strong>Not a drug;</strong> not intended to diagnose, treat, cure, or prevent any disease.</p>

      <blockquote class="pullquote reveal">
        <p>‚Äú<strong>By week two</strong> I wasn‚Äôt raiding the pantry at 9pm. It‚Äôs the first routine I‚Äôve actually <em>stuck with</em>.‚Äù</p>
        <cite>‚Äî <em>Alex R., Verified</em></cite>
      </blockquote>

      <h2>What you‚Äôll feel (week 1‚Äì4)</h2>
      <ol class="timeline">
        <li><strong>Week 1:</strong> Portions feel easier; <em>cravings drop</em></li>
        <li><strong>Week 2:</strong> Afternoon energy <strong>stabilizes</strong></li>
        <li><strong>Week 3:</strong> Clothes feel <em>more forgiving</em></li>
        <li><strong>Week 4:</strong> The rhythm <strong>sticks</strong></li>
      </ol>

      <section class="faq reveal" id="faq">
        <h2>FAQs</h2>
        <div class="faq-item">
          <button class="faq-question"><strong>Is it safe?</strong></button>
          <div class="faq-answer"><p><strong>Yes.</strong> The formula uses <em>research‚Äëbacked ingredients</em> with a strong safety profile. If you‚Äôre under care, <em>consult your provider</em>.</p></div>
        </div>
        <div class="faq-item">
          <button class="faq-question"><strong>Do I need a prescription?</strong></button>
          <div class="faq-answer"><p><strong>No.</strong> This is a <em>non‚Äëprescription</em> wellness product.</p></div>
        </div>
        <div class="faq-item">
          <button class="faq-question"><strong>How fast will I notice changes?</strong></button>
          <div class="faq-answer"><p>Many people notice changes in <em>appetite and energy</em> within <strong>1‚Äì2 weeks</strong>, with continued improvements after week 3.</p></div>
        </div>
      </section>

      <section class="references">
        <h2>References</h2>
        <ul>
          <li><em>Clinical Journal of Metabolic Health, 2023</em></li>
          <li><em>National Wellness Review, 2024</em></li>
        </ul>
      </section>
    </article>
  </main>

  <!-- Checkout Modal (3-Step) -->
  <div id="checkoutModal" class="modal modal-checkout" role="dialog" aria-modal="true" aria-labelledby="coTitle" aria-hidden="true">
    <div class="modal-content checkout-card" role="document">
      <button class="modal-close" id="checkoutClose" aria-label="Close">√ó</button>

      <!-- Step 1: User Info -->
      <form id="coStep1" class="co-pane" novalidate>
        <h3 class="co-h3">Where Should We Send Your Free Bottles?</h3>
        <div class="co-grid">
          <label>Full Name
            <input type="text" name="name" autocomplete="name" placeholder="Full Name" required />
          </label>
          <label>Email
            <input type="email" name="email" autocomplete="email" placeholder="Email" required />
          </label>
          <label>Phone
            <input type="tel" name="phone" inputmode="tel" autocomplete="tel" placeholder="Phone" required />
          </label>
          <label>Street Address
            <input type="text" name="address" autocomplete="street-address" placeholder="Street Address" required />
          </label>
          <div class="co-row">
            <label>City
              <input type="text" name="city" autocomplete="address-level2" placeholder="City" required />
            </label>
            <label>State
              <input type="text" name="state" maxlength="2" placeholder="State" required />
            </label>
            <label>Zip
              <input type="text" name="zip" inputmode="numeric" maxlength="5" placeholder="Zip Code" required />
            </label>
          </div>
        </div>
        <button type="submit" class="btn-main btn-lg co-next">Continue</button>
      </form>

      <!-- Step 2: Payment Method -->
      <section id="coStep2" class="co-pane" hidden aria-hidden="true">
        <h3 class="co-h3">How Many Bottles Do You Want?</h3>

        <div class="co-qty">
          <button type="button" class="qty-btn qty-dec" aria-label="Decrease">‚àí</button>
          <input type="text" id="coQty" value="1" inputmode="numeric" aria-label="Quantity">
          <button type="button" class="qty-btn qty-inc" aria-label="Increase">+</button>
        </div>
        <p class="co-free">You get <strong><span id="coFreeQty">1</span> FREE</strong> (match of your selection)</p>

        <div class="co-price">
          <span class="was">$90</span>
          <span class="now">$45</span> <span class="per">/ bottle</span>
        </div>

        <div class="co-methods co-methods--tight">
          <button class="co-method" data-method="card"   data-discount="0">
            <div class="co-title">Credit / Debit Card</div><span class="co-badge">Popular</span>
          </button>
          <button class="co-method" data-method="venmo"  data-discount="10">
            <div class="co-title">Venmo</div><span class="co-discount">10% off</span>
          </button>
          <button class="co-method" data-method="cashapp" data-discount="10">
            <div class="co-title">Cash App</div><span class="co-discount">10% off</span>
          </button>
          <button class="co-method" data-method="paypal" data-discount="10">
            <div class="co-title">PayPal</div><span class="co-discount">10% off</span>
          </button>
          <button class="co-method" data-method="crypto" data-discount="15">
            <div class="co-title">Crypto</div><span class="co-discount">15% off</span>
          </button>
        </div>

        <div class="co-sticky">
          <div class="co-totals" role="group" aria-label="Order totals">
            <div><span>Items</span><span id="coItemsLine">2 bottles (1 paid + 1 free)</span></div>
            <div><span>Merch</span><span id="coMerch">$90.00</span></div>
            <div><span>Method discount</span><span id="coDisc">-$0.00</span></div>
            <div><span id="coTaxLabel">Tax</span><span id="coTax">$0.00</span></div>
            <div><span>Shipping</span><span class="co-free-ship">FREE</span></div>
            <div class="co-total-row"><span>Total</span><span id="coTotal">$90.00</span></div>
          </div>

          <div class="co-actions">
            <button class="btn-main btn-lg co-next" id="coToStep3" disabled>Continue</button>
            <button class="btn-main btn-sm co-back" id="coBackTo1" type="button">Back</button>
          </div>

          <p class="co-secure">üîí 100% encrypted checkout ‚Ä¢ 60-Day Guarantee</p>
        </div>
      </section>

      <!-- Step 3: Payment Details -->
      <section id="coStep3" class="co-pane" hidden aria-hidden="true">
        <div id="coPayWrap"></div>
        <div class="co-terms">
          <label>
            <input type="checkbox" id="coTos" required />
            I agree to the Terms and understand this is a <strong>free sample</strong> and I will only be charged for shipping.
          </label>
        </div>
        <div class="co-actions">
          <button class="btn-main btn-lg co-submit" id="coSubmit">Complete Reservation</button>
          <button class="btn-main btn-sm co-back" id="coBackTo2" type="button">Back</button>
        </div>
        <p class="tiny muted co-trust">üîí 256‚Äëbit SSL ‚Ä¢ üöö Free shipping today ‚Ä¢ ‚Ü©Ô∏è 60‚ÄëDay Guarantee</p>
      </section>

      <div id="checkoutSuccess" class="co-success" hidden>
        <h4>You're in. üéâ</h4>
        <p>We‚Äôve reserved your free bottles. Look for a confirmation email shortly.</p>
        <a href="#" class="btn-main btn-lg" onclick="checkoutClose();return false;">Back to article</a>
      </div>
    </div>
  </div>

  <footer class="site-footer">
    <p>&copy; <span id="year"></span> Health Template Co.</p>
  </footer>

  <script>
  /* ===== script.js ‚Äî date, countdown, scroll progress ===== */
  (function(){
    const today = new Date();
    const opts = {year:'numeric', month:'long', day:'numeric'};
    const todayEl = document.getElementById('todayDate');
    if (todayEl) todayEl.textContent = today.toLocaleDateString(undefined, opts);
    const yEl = document.getElementById('year'); if (yEl) yEl.textContent = today.getFullYear();
    const cdEl = document.getElementById('countdown');
    if (cdEl){
      function tick(){
        const now = new Date();
        const end = new Date(); end.setHours(23,59,59,999);
        const ms = Math.max(0, end - now);
        const h = String(Math.floor(ms/3.6e6)).padStart(2,'0');
        const m = String(Math.floor(ms%3.6e6/6e4)).padStart(2,'0');
        const s = String(Math.floor(ms%6e4/1e3)).padStart(2,'0');
        cdEl.textContent = `${h}:${m}:${s}`;
        requestAnimationFrame(tick);
      } tick();
    }
    const bar = document.getElementById('scrollProgress');
    if (bar){
      const onScroll = () => {
        const el = document.documentElement;
        const scrolled = (el.scrollTop)/(el.scrollHeight - el.clientHeight);
        bar.style.transform = `scaleX(${Math.max(0,Math.min(1,scrolled))})`;
      };
      document.addEventListener('scroll', onScroll, {passive:true});
      onScroll();
    }
  })();
  </script>

  <script>
  /* ===== checkout3.js ‚Äî mobile-solid open + polished steps ===== */
  (function(){
    "use strict";

    const modal = document.getElementById("checkoutModal");
    if (!modal) return;

    const step1 = document.getElementById("coStep1");
    const step2 = document.getElementById("coStep2");
    const step3 = document.getElementById("coStep3");

    const toStep3 = document.getElementById("coToStep3");
    const back1   = document.getElementById("coBackTo1");
    const back2   = document.getElementById("coBackTo2");

    const qtyInput= document.getElementById("coQty");
    const payWrap = document.getElementById("coPayWrap");
    const tos     = document.getElementById("coTos");
    const submit  = document.getElementById("coSubmit");
    const closeX  = document.getElementById("checkoutClose");
    const success = document.getElementById("checkoutSuccess");

    const priceWas = step2.querySelector(".co-price .was");
    const priceNow = step2.querySelector(".co-price .now");

    const MSRP=90, DISPLAY=45, SALE=90, TAX=0.0875, SHIPPING=0;
    let qty=1, method=null, discount=0;

    const $ = (id)=>document.getElementById(id);
    const fmt = (n)=>`$${n.toFixed(2)}`;
    const show=(el)=>{ if(el){ el.hidden=false; el.setAttribute("aria-hidden","false"); } };
    const hide=(el)=>{ if(el){ el.hidden=true;  el.setAttribute("aria-hidden","true");  } };

    function setStep(n){
      if (n===1){ show(step1); hide(step2); hide(step3); step1.querySelector('input')?.focus({preventScroll:true}); }
      if (n===2){ hide(step1); show(step2); hide(step3); }
      if (n===3){ hide(step1); hide(step2); show(step3); step3.querySelector('input,button')?.focus({preventScroll:true}); }
    }

    function totals(){
      const free=qty, merch=qty*SALE, disc=merch*(discount/100);
      const taxable=Math.max(0, merch-disc), tax=taxable*TAX, total=taxable+tax+SHIPPING;
      const set=(id,v)=>{ const n=$(id); if(n) n.textContent=v; };
      set("coFreeQty", String(free));
      set("coItemsLine", `${qty+free} bottles (${qty} paid + ${free} free)`);
      set("coMerch", fmt(merch));
      set("coDisc", disc>0?`-${fmt(disc)}`:"$0.00");
      set("coTax", fmt(tax));
      set("coTotal", fmt(total));
      const ship = step2.querySelector(".co-free-ship"); if (ship) ship.textContent = SHIPPING===0 ? "FREE" : fmt(SHIPPING);
      if (qtyInput) qtyInput.value = String(qty);
    }

    const CTA_SEL = ".floating-cta,[data-cta],[data-open-checkout],.open-checkout,.cta,a[href='#offer'],a[href*='#offer'],a[href*='#checkout']";
    let openGuard=0;

    function openModal(e){
      const now=Date.now(); if (now-openGuard<250) return; openGuard=now;
      e?.preventDefault?.(); e?.stopPropagation?.();
      modal.classList.add("show","co-fullscreen");
      document.documentElement.setAttribute("data-checkout-open","1");
      document.body.style.overflow="hidden";
      priceWas && (priceWas.textContent=fmt(MSRP));
      priceNow && (priceNow.textContent=fmt(DISPLAY));
      qty=1; method=null; discount=0; if(toStep3) toStep3.disabled=true; totals(); setStep(1);
    }
    function closeModal(e){
      e?.preventDefault?.(); e?.stopPropagation?.();
      modal.classList.remove("show","co-fullscreen");
      document.documentElement.removeAttribute("data-checkout-open");
      document.body.style.overflow="";
    }
    window.checkoutOpen=openModal; window.checkoutClose=closeModal;

    function bindCTAs(){
      document.querySelectorAll(CTA_SEL).forEach(el=>{
        if(el.__bound) return;
        const h=(ev)=>openModal(ev);
        el.addEventListener("click",h,{capture:true});
        el.addEventListener("touchstart",h,{capture:true, passive:false});
        el.addEventListener("touchend",h,{capture:true, passive:false});
        el.addEventListener("pointerup",h,{capture:true});
        el.__bound=true;
      });
    }
    bindCTAs();
    new MutationObserver(bindCTAs).observe(document.documentElement,{subtree:true,childList:true,attributes:true});

    // Document-level safety net
    function trap(ev){
      const t = ev.target.closest?.(CTA_SEL);
      if (t){ openModal(ev); }
    }
    document.addEventListener("touchstart",trap,{capture:true,passive:false});
    document.addEventListener("touchend",trap,{capture:true,passive:false});
    document.addEventListener("pointerup",trap,{capture:true});
    document.addEventListener("click",trap,{capture:true});

    // Close
    closeX && closeX.addEventListener("click", closeModal);
    modal.addEventListener("click",(e)=>{ if (e.target===modal) closeModal(e); });
    document.addEventListener("keydown",(e)=>{ if (e.key==="Escape" && modal.classList.contains("show")) closeModal(e); });

    // Step 1
    step1 && step1.addEventListener("submit",(e)=>{
      e.preventDefault();
      const req=["name","email","address"].map(n=>step1.querySelector(`[name='${n}']`));
      const ok=req.every(i=>i && i.value.trim());
      req.forEach(i=>i && (i.style.borderColor = i.value.trim()? "" : "#ff5a6e"));
      if(!ok) return; setStep(2); totals();
    });

    // Step 2
    step2 && step2.addEventListener("click",(e)=>{
      if(e.target.closest(".qty-inc")){ qty=Math.min(99,qty+1); totals(); return; }
      if(e.target.closest(".qty-dec")){ qty=Math.max(1, qty-1); totals(); return; }
      const btn=e.target.closest(".co-method"); if(!btn) return;
      step2.querySelectorAll(".co-method").forEach(b=>b.removeAttribute("aria-selected"));
      btn.setAttribute("aria-selected","true");
      method = btn.dataset.method || "card";
      discount = parseFloat(btn.dataset.discount || "0") || 0;
      toStep3 && (toStep3.disabled=false);
      totals();
    });
    step2 && step2.addEventListener("input",(e)=>{
      if (e.target.id!=="coQty") return;
      const v=e.target.value.replace(/[^0-9]/g,"");
      qty = Math.max(1, Math.min(99, parseInt(v||"1",10)));
      e.target.value = String(qty); totals();
    });
    toStep3 && toStep3.addEventListener("click",(e)=>{
      e.preventDefault(); if(!method) return; renderPay(method); setStep(3);
    });
    back1 && back1.addEventListener("click",()=>setStep(1));
    back2 && back2.addEventListener("click",()=>setStep(2));

    // Step 3
    function renderPay(m){
      const txt=(t)=>`<div class="altpay"><h4>${t[0]}</h4><p>${t[1]}</p></div>`;
      const map={
        card:`<fieldset class="cardset"><legend>Card details</legend>
                <label>Card number<input type="text" inputmode="numeric" placeholder="4242 4242 4242 4242"></label>
                <div class="co-row">
                  <label>Expiry<input inputmode="numeric" placeholder="MM/YY"></label>
                  <label>CVC<input inputmode="numeric" maxlength="4"></label>
                  <label>ZIP<input inputmode="numeric" maxlength="5"></label>
                </div>
              </fieldset>`,
        venmo:txt(["Venmo","Send to @YourHandle ‚Äî 10% off applied"]),
        cashapp:txt(["Cash App","Send to $YourCashtag ‚Äî 10% off applied"]),
        paypal:txt(["PayPal","Redirect to PayPal ‚Äî 10% off applied"]),
        crypto:txt(["Crypto","BTC/ETH/USDC ‚Äî 15% off applied; address next"])
      };
      payWrap.innerHTML = map[m] || map.card;
    }
    submit && submit.addEventListener("click",(e)=>{
      e.preventDefault();
      if (!tos?.checked){ tos?.focus(); return; }
      hide(step3); show(success);
    });

    // initial
    priceWas && (priceWas.textContent="$90");
    priceNow && (priceNow.textContent="$45");
    totals();
  })();
  </script>
</body>
</html>
